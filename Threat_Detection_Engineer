What is SOC?
-- Security Operation Center
-- Central Hub of Organization's cybersecurity operations
-- Responsible for monitoring, detecting, responding to and mitigating cyber threats in real-time.
-- Provided continous monitoring and protection against cyberattack, data breaches and compliance risks.
-- Eg- Human nervous system/ brain which recives million ofsignal from body. Similarly, SOC recives millions of alerts/logs from different sources-
a. Firewall, Router, VPN logs
b. EDR
c. User Behavior Analytics (UEBA).
d. Cloud services, Databases
Out of all the above only few dozen of alerts/incidents are actionable which we get after correlating, filtering and enrichment.


Tier-1 Specalist-
-- Collecting raw data
-- Reviewing alarms incident
-- Determine the severity or criticality of alert.
-- Confirm is the alert is True positive or False Positive.
-- Monitoring, managing and configuring tools
-- Escalate to Tier-2
-- Eg- Data Exfilteration

Tier-2 Specialist-
-- Higher severity incident.
-- Actively montioring
-- Use of IOC and Rules.
-- Scope of attack and aware of affected/compromised systems.
-- eg- True postive Phishing alert which is has malicious link clicked by the user.

Tier-3 Specialist/ Threat Hunter-
-- Actively monitoring
-- Research for new malware present in the world and create IOC and rules for same.
-- Review Tier-1 and Tier 2 provided data.


>> All Tiers comes under Incident Response Coordinator.


SOC Manager-
-- Hiring and provide training.
-- Managing team.


Additional roles-
1. Reverse Engineers-
-- Check malware and how it works. How it came into the system (decomplie malware).
-- They decompile malware samples in sandboxed or virtual environments.
-- Goal is to identify Indicators of Compromise (IOCs), command-and-control (C2) mechanisms, persistence techniques, and exploit payloads.
-- Create custom detection signatures, strengthens EDR tools, and guides patching or remediation efforts


2. Threat Hunters- 
-- Proactively search for advanced threat by looking at the logs.
-- Use Frameworks, Threat intelligence, Behavioral Analysis.
-- Think about the compromised scenerios and accordingly check the logs, memory dumps, Endpoint telemetry.
-- Improving detection rules, refining SIEM correlation logic, and closing visibility gaps. 
-- Also called as “offensive defense” of the SOC.



3. Forensic Analyst-
-- Deeper analysis once an incident occurred.
-- Post-mometurm of alert/incidents.
-- Recover deleted files, analyze registry keys, inspect system memory, and trace timelines from log files. 
-- Work is critical during incident response, litigation, or regulatory investigations.
-- Using tools like FTK, EnCase, or Autopsy, they aim to preserve evidence, identify root causes, and recommend long-term mitigations while maintaining chain-of-custody procedures for legal admissibility.


4. Security Architects/ Security Consultant-
-- Design the blueprint of the organization’s security posture. 
-- They determine how tools (e.g., SIEM, EDR, IDS/IPS) integrate, how zones are segmented.
-- How policies are enforced across on-prem, cloud, and hybrid environments. 
-- Confim how we select alert/incident risk, select technologies needs. 
-- Security controls aligned with compliance frameworks (NIST, ISO 27001, etc.).

=========================================================================================================

Benefits of SOC-
-- 24/7 Monitoring of Threat and responding to them.
-- Incident Handling
-- Early detection of Threats
-- Expertise and Specialization handles by different profiles.


=======================================================================================================

SOC Workflow-

Data Collection --> Data Normalization and Correlation --> Alert Triage --> Incident Investigation --> Incident Investigation --> Recovery --> Recovery, Documentation and Post-incident review.


1. Data Collection-
Gathering of raw data from different sources.

a. Network Devices- 
-- Ex. Firewall, Router, Swtiches, IDS/IPS.
-- Data collected- Traffic flow (Lateral Movement, Privelage Escalation), Blocked ports (Port scanning), Denied connection, Scanning attempts.

c. Endpoint Devices-
-- Ex. EDR, AV, OS
-- Data Collectede- File access, Process creation (Event Viewer, Task manager), Command-line usage (access done on CMD and PowerShell), Registry changes.

d. Servers & Applications-
-- Ex- Database Servers, Web Servers, Email Servers.
-- Data Collected- Authentication logs (Brute-force login/attempts), SQL Queries (SQL injection/ Cross-site scripting), Web Requests, Access Logs.


e. Identity & Access Management-
-- Ex. Active Directory, Okta, LDAP
-- Data Collected- Login, failed login attempts, User provisioning and de-provisioning.

f. Cloud Infrastructure-
-- Ex. AWS CloudTrail, Azure Logs, GCP StackDriver
-- Data Collected- API Calls, Account Changes, Cloud Resources modifications.


g. Security Tools-
-- Ex. SIEM, SOAR, DLP, UEBA
-- Data Collected- Alert, Correlation Output, Risk Scores


h. Threat Intelligence Feeds-
-- Ex. STIX/TAXII, OSINT, Commercial Feeds.
-- Data Collected- Known malicious IPs/Domains, TTPs, IOCs.


=========================================================================================================

2. Data Normalization and Crorelation-

Data Normalization- Cleaning and Structuring the noise.

Noramlization- Process of converting various log formats from different sources into a common structured schema so that they can be efficiently processed, analyzed, and correlated.

Ex.-
Without Normalization:
>> A firewall logs says "sc_ip"
>> A linux logs says "source-address"
>> A cloud logs says "ip.src"

For getting the alerting and searching, they all need to mean the same thing, so that they're noramlized into a standard field- source_ip.


Data Correkation- Connecting the Dots

Correlation- Process of linking multiple normalized events across systems to detect suspicious patterns that single events alone would miss.

Ex.-
>> A login from a new device which is followed by a privilege escalation and followed by a large data download of a malaicious .exe file.


=======================================================================================================


3. Alert Triage- Catergorzing alert depending on their criticality. Ex.- First solve the Critical alert, then High followed by Medium and then Low.

Alert Triage- Process in SOC where incoming security alerts are evaluated, categorized, prioritized, and routed based on their severity, credibility and potential impact. 
Typically handled by Tier 1 SOC analyst.

Ex.- Think of Emergency room where Nurse (SOC Tier 1)
>> Alert- Patients walk in ER.
>> Triage Nurse (Tier 1 Analyst) checks-
    + Check for the symptoms (alert details)
    + Ask key questions (context enrichment)
    + Decides Urgency- Life-Threating (Malware on Critical DB servers) or Minor (Failed login attempts)
    + Routes Patient to specialist (Tier 2 or Incident Response Team) or discharges them (False Positive).
Just like nurse who doesn't perform surgery but know which right case should go to the right doctor, TIer 1 triage doesn't resolve the issue but ensures right attention is given.


Ex.2-
>> Receive Alert from SIEM, EDR or SOAR
>> Enrich alert with IP reputation, Hash, User info., etc.
>> Evaluate Credibility- Is alert real or False Positive.
>> Assess Severity- Confirm is the activity suspicious, malicious.
>> Categorize the alert (Low, Medium, High, Critical)
>> Respond or Escalate

Purpose of Alert Triage-
>> Filter out False Positive.
>> Identify true security incidents.
>> Determine priority based on criticality. (eg. assest value, threat level)
>> Escalate to higher-tier analyst when needed.
>> Document finding for audit and Incident Response.


Reported Created include atleast these items-
>> Who- Who performed the action
>> What- What action was performed
>> When- When did the action started and ended
>> Where- From where did they started the perform the action (IP or Website)
>> Why- Why do you think this alert is critical, high, medium or low


==================================================================================

4. Incident Investigation-
>> Step 1- Initial Alert Intake (Tier 1)
  + 100+ alerts generated.
  + Tier 1 perform alert triage-
  + Out of 100 find that 80-90 are false positive or low severity alerts.
  + 10-15 alerts are escalated to Tier 2 where alert show suspicious behavior or need deeper analysis.

>> Step 2- Deep investigation (Tier 2)
  + Escalated alerts are- Correlated, Cross referenced with Threat Intel, invetigated using MITRE technique
  + Confirms 9 are confirmed Safe through investigation and Containable incidents 
  + 1 alerts is identified as a serious/complex case which needs specialized skills.

>> Step 3- 
  + High Severity alert which involves-
    a. Advanced Persistent Threat (APT)
    b. Insider activity
    c. Malware that bypassed detection
    d. Cloud misconfiguration exploitation

  + Tier 3 perform-
    a. Memory analysis
    b. Packet capture review (Wireshark)
    c. Reverse Engineering
    d. RCA


=================================================================================

5. Incident response-

Steps Taken in IR phase-
1. Confirmation & Classification
    + Tier 2/Tier3 confirms that actual security incident has occurred.
    + Incident is classified (eg- Malware infection, Data breach, Insider Threat)

2. Containment (short-term solution)
    + Isolate the device to stop spread. (Disable account, unplug device from network)
    + USe SOAR playbook to automate quick response actions.

3. Evidence Preservation-
    + Forensics team captures memory dumps, disk images, logs, PCAPs to preserve volatile evidence.
    + Maintained if legal action is needed.

4. Threat Eradication-
    + Remove malware, kill malicious processed, pathc explioted vulnerabilities.
    + Revoke compromised credentials or reset passowrds.

5. Internal communication-
    + Alert relevant teams- IT, Legal, Complaince, Management
    + Avoid public panic or information leaks until fact is clear


==========================================================================================


6. Recovery & Documentation-

1. System Restoration-
  + Restore from back-ups or re-image the device.
  + Validate the device integrity and confirm the threat is fully removed.

2. Reconnection and Testing-
  + Reconnect cleaned device to network gradually and in isolated env. to confirm that device is safe.
  + Test business functionality (eg. Can employees login, app works, services run)

3. Patching and Hardening-
  + Apply missing patches and security updates that are missing in all the devices.
  + Disable unused ports/services, Access control tightening, Implement MFA if not present.

4. Monitoring for recurrence-
  + Monitoring the affected devices for check the if there are any traces of attacker.
  + Use deception tools (honeypots) or aggressive loggin temporarily.

5. User Awareness-
  + If applicable inform affected user. (eg. Password reset, phishing awareness)
  + Legal/Compliance notification if PII or Sensitive data was breached.



=================================================================================

SOC Tools

SOC Tools----> Core Tools  ---> Advanced Tools


1. SIEM (Security and Event Management tool)- 
    + It is Central System that collects, aggregates, correlates, and analyzes logs from across your environment.
    + Purpose- Detects and alerts on suspicious activity using rules, analytics and correlation engines.
    + Ex.- Splunk, IBM Qradar, Sentinal, ArcSight, LogRhythm.
    + TIER 1 Role- Monitor dashboards, investigate low/medium alerts.
    + TIER 2 Role- Create/Customize correlation rules, threat hunting, advanced incdient investigations.


2. SOAR (Security Orchestration, Automation and Response)- SOAR platforms automate incident response using playbooks, reducing manual work and response time.
    + Set of technologies that enables security teams to streamline and automate their security operations.
    + Its a critical components for modern SOC. 
    + SOAR platforms help SOCs by orchestrating workflows, automating repetitive tasks, and improving the overall efficiency, and effective of incident response.

>> Security Orchestration-

>> Automation-

>> Response-


3. TIP (Threat Intelligence Platform)- A TIP centralizes and enriches threat intelligence feeds to add context to indicators of compromise (IOCs)
    + Provide security team with info. on known malware & other threats.
    + If you haven't seen any of a malware so we can use this platform where someone has came across this malware in world.
    + Ex.- Anomali, Threat connect, 

4. NTA (Network Traffic Analysis)- NTA tools use behavioral analytics to detect anomalies like laterla movement and data exfilteration across n/w.
    + Analyze network traffice to security threats, performance issues and other anomalies.
    + Ex-. Dark trace 

5. IDS/IPS (Intruder Detection System/ Intruder Prevention System)- IDS/IPS monitor n/w traffic for malicious patterns, with IPS capable of blocking threats in real time.
    + 

6. EDR (Endpoint Detection and Response)-
    + Endpoint detection and response (EDR) software is used by security operations teams to detect, contain, investigate and remediate cyberattacks—such as ransomware and other malware.
    + EDR tools are used to discover suspicious activities on hosts and endpoints that are connected to the network—such as mobile phones, desktops, laptops, and virtual machines. 
    + EDR software integrates real-time continuous monitoring and collection of endpoint data and actionable threat intelligence with rules-based, automated cyber threat response and analysis capabilities. Whether detecting, responding, or remediating, EDR solutions offer a great first and last line of defense for networked computer workstations

===================================================

Advanced Tools-

7. Vulnerability Tools-
    + Types of VA tools-
        a. Network-based scanners-
            >> Ex.- Nmap,

        b. Web application scanners-
            >> Ex.- Burpsuit

        c. Host-based scanners-
            >> Ex.- Nessus Scanner

        d. Wireless network scanners-
            >> Ex.- 

Widely used tools-
>> Nessus-
>> Qualys-
>> OpenVas- Alternative to Nessus as it is a open-source.
>> Nmap-
>> Acunetix- 
>> Burp Suite- 


8. Ticketing Tools-
    + Tracking and escalating tool.
    + Which ticket is assigned to whom.
    + Tools Ex.- 
        Jira- 
        ServiceNow- 
        Zendesk-
        RT (Request Tracker)-
        TheHive- OpenSource
        FreshService-


9. Sandboxing Tools-
    + USed for experimenting Malware.
    + Tools Ex.-
        Cuckoo SandBox- Open-Source



10. UEBA (USer and Entity Behavior Analytics)
    + Tools Ex.- Splunk


11. Deception Tools-
    + Tools Ex.- 
        Honeypots
        HoneyNet
        HoneyMap
        HoneyToken- Ex. CanaryToken


============================================================

SOC KPI's and Metrics

1. Operational Metrics-
    + Mean time to Detect (MTTD)-
    + Mean time to Response (MTTR)-
    + Incident Response Time-

2. Alert Metrics-
    + False Positive Rate- Ex. Zoom meeting is catorgized as Data Exfilteration attempt but its False Positive as Zoom meeting is consuming alot of amount of data.
    + True Positive Rate- 
    + Alert Escalation Rate-
            Alert Escalation Rate= (No. of alerts escalated/ No. of alerts received) x 100



3. Strategic Metrics-
    + Patch Rate- 
    + Compliance Adherence Rate-
        Adherence Score= (92x1) + (6x0.5)/100 x 100 = 95%

        >> ISO 27001
        >> NIST CSF
        >> PCI DSS
        >> HIPAA
    + Cost Per Incident-
    







